name: Build
on: [push, pull_request, release]
jobs:
   deploy:
      runs-on: ubuntu-latest
      steps:
         - uses: actions/checkout@v2.3.4
           with:
              persist-credentials: false
              fetch-depth: 0
         - uses: cachix/install-nix-action@v12
           with:
              install_url: https://github.com/numtide/nix-flakes-installer/releases/download/nix-3.0pre20201007_5257a25/install
              extra_nix_config:
                 experimental-features = nix-command flakes
         - run: nix build . -o site
         - name: Deploy ðŸš€
           uses: JamesIves/github-pages-deploy-action@releases/v3
           with:
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              BRANCH: master # The branch the action should deploy to.
              FOLDER: site # The folder the action should deploy.
              CLEAN: true # Automatically remove deleted files from the deploy branch
